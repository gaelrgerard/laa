<!-- HTML for static distribution bundle build -->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="UTF-8">
        <title>LAA <-> SAM SM Swagger UI</title>
        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.18.1/swagger-ui.css">
        <link rel="icon" type="image/png" href="https://petstore.swagger.io/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="https://petstore.swagger.io/favicon-16x16.png" sizes="16x16">
        <style>
            html {
                box-sizing: border-box;
                overflow: -moz-scrollbars-vertical;
                overflow-y: scroll;
            }

            *,
            *:before,
            *:after {
                box-sizing: inherit;
            }

            body {
                margin: 0;
                background: #fafafa;
            }
        </style>
    </head>

    <body>
        <div id="swagger-ui">
        </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.18.1/swagger-ui-bundle.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.18.1/swagger-ui-standalone-preset.js"></script>
        <script>
            // Examples map
            const req_examples = {};
            const examples = {};

        // Custom plugin for logic that happens before the response element is created
            const CustomPlugin = () => {
                return {
                    wrapComponents: {
                        request: (Original, { React, oas3Actions, oas3Selectors }) => (props) => {
                                const contentType = oas3Selectors.requestContentType(props.path, props.method);
                                const externalValue = props.request.getIn(['content', contentType, 'req_examples', props.activeExamplesKey, 'externalValue']);
                                // Check if externalValue field exists
                                if (externalValue) {
                                    // Check if examples map already contains externalValue key
                                    if (req_examples[externalValue]) {
                                        // Set example value directly from examples map
                                        props.request = props.request.setIn(['content', contentType, 'req_examples', props.activeExamplesKey, 'value'], req_examples[externalValue]);
                                    } else {
                                        // Download external file
                                        fetch(externalValue)
                                                .then(res => res.text())
                                                .then(data => {
                                                    // Put downloaded file content into the examples map
                                                    req_examples[externalValue] = data;
                                                    // Simulate select another example action
                                                    oas3Actions.setActiveExamplesMember({
                                                        "name": 'fake',
                                                        "pathMethod": [props.path, props.method],
                                                        "contextType": "requests",
                                                        "contextName": props.code
                                                    });
                                                    // Reselect this example
                                                    oas3Actions.setActiveExamplesMember({
                                                        "name": props.activeExamplesKey,
                                                        "pathMethod": [props.path, props.method],
                                                        "contextType": "requests",
                                                        "contextName": props.code
                                                    });
                                                })
                                                .catch(e => console.error(e));
                                    }
                                }
                                return React.createElement(Original, props);
                            },
                        response: (Original, { React, oas3Actions, oas3Selectors }) => (props) => {
                                const contentType = oas3Selectors.responseContentType(props.path, props.method);
                                const externalValue = props.response.getIn(['content', contentType, 'examples', props.activeExamplesKey, 'externalValue']);
                                // Check if externalValue field exists
                                if (externalValue) {
                                    // Check if examples map already contains externalValue key
                                    if (examples[externalValue]) {
                                        // Set example value directly from examples map
                                        props.response = props.response.setIn(['content', contentType, 'examples', props.activeExamplesKey, 'value'], examples[externalValue]);
                                    } else {
                                        // Download external file
                                        fetch(externalValue)
                                                .then(res => res.text())
                                                .then(data => {
                                                    // Put downloaded file content into the examples map
                                                    examples[externalValue] = data;
                                                    // Simulate select another example action
                                                    oas3Actions.setActiveExamplesMember({
                                                        "name": 'fake',
                                                        "pathMethod": [props.path, props.method],
                                                        "contextType": "responses",
                                                        "contextName": props.code
                                                    });
                                                    // Reselect this example
                                                    oas3Actions.setActiveExamplesMember({
                                                        "name": props.activeExamplesKey,
                                                        "pathMethod": [props.path, props.method],
                                                        "contextType": "responses",
                                                        "contextName": props.code
                                                    });
                                                })
                                                .catch(e => console.error(e));
                                    }
                                }
                                return React.createElement(Original, props);
                            }
                    }
                };
            };


            window.onload = function () {

                // Begin Swagger UI call region
                const ui = SwaggerUIBundle({
                    "dom_id": "#swagger-ui",
                    deepLinking: true,
                    presets: [
                        SwaggerUIBundle.presets.apis,
                        SwaggerUIStandalonePreset
                    ],
                    plugins: [
                        SwaggerUIBundle.plugins.DownloadUrl,
                        // Add custom plugin for examples
                        CustomPlugin
                    ],
                    layout: "StandaloneLayout",
                    validatorUrl: "https://validator.swagger.io/validator",
                    url: "spec/laa.yaml"
                });


                // End Swagger UI call region


                window.ui = ui
            }
        </script>


    </body>
</html>
